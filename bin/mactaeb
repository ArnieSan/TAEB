#!/usr/bin/perl
use strict;
use warnings;
use FindBin '$Bin';

my $interface;

# XXX: I tried using Module::Install::Can::can_run but it always returned true..
if (`which nethack`) {
    my $dialog = join " ", split /\n/, q{
        /Applications/CocoaDialog.app/Contents/MacOS/CocoaDialog
        msgbox
        --button1 Local
        --button2 Telnet
        --button3 Cancel
        --text "How would you like TAEB to play NetHack?"
        --informative-text "The Telnet interface requires an internet connection."
        --title "Select an interface"
        --icon globe
    };
    my $interface_id = `$dialog`;

    exit if $interface_id == 3; # cancel

    $interface = $interface_id == 1 ? "Local" : "Telnet";
}
else {
    $interface = "Telnet";
}

print "Selected the $interface interface.\n";

exec $^X, "$Bin/taeb", "--config={interface: $interface}";

